<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Vista previa del formulario</title>
  <link rel="stylesheet" href="/styleform.css">
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      display: flex;
      justify-content: center;
      padding: 1em;
      color: #222;
      background-color: #fff;
    }
    .container {
      width: 100%;
      max-width: 750px;
      text-align: center;
    }
    .logo-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 0.5em;
    }
    .logo-header img {
      width: 100px;
      height: auto;
    }
    .titulo-formulario {
      text-align: center;
      flex-grow: 1;
      margin-left: -100px;
    }
    .titulo-formulario h2 {
      font-size: 16pt;
      margin: 0;
      line-height: 1.2;
    }
    .titulo-formulario h3 {
      font-size: 13pt;
      margin: 0;
      line-height: 1.2;
    }
    .codigo-ref {
      display: flex;
      justify-content: space-between;
      margin: 0.5em 0 1em 0;
      font-size: 11pt;
    }
    .bloque {
      border: 1px solid #444;
      padding: 0.8em 1em;
      margin: 1em auto;
      border-radius: 6px;
      background-color: #fdfdfd;
      text-align: left;
    }
    .grid-2 {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0.3em 1em;
    }
    .grid-2 p {
      margin: 0.2em 0;
      font-size: 11pt;
    }
    .full {
      grid-column: span 2;
    }
    .botones {
      margin-top: 1.5em;
    }
    .pie-firma {
      margin-top: 2em;
      text-align: center;
      font-size: 10pt;
    }
    .firmas {
      display: flex;
      justify-content: space-between;
      margin-bottom: 1em;
    }
    .firma-bloque {
      width: 48%;
    }
    .linea-firma {
      border-bottom: 1px solid #000;
      height: 2em;
      margin-bottom: 0.3em;
    }
    .separador-legal {
      border-top: 2px solid #000;
      margin: 1em auto;
      width: 100%;
    }
    .texto-legal {
      margin-top: 0.5em;
      font-size: 9pt;
      text-align: justify;
    }
    @media print {
      @page {
        margin: 1.5cm;
        size: A4 portrait;
      }
      body {
        font-size: 11pt;
        margin: 0;
      }
      .botones,
      .btn,
      button {
        display: none;
      }
      html,
      body {
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
      }
    }
  </style>
</head>
<body>
  <div class="container">

    <div class="logo-header">
      <img src="/img/LogoAlcaldia.png" alt="Logo institucional">
      <div class="titulo-formulario">
        <h2>ALCALD√çA MUNICIPAL LA LIBERTAD ESTE</h2>
        <h3>FORMULARIO √öNICO DE SOLICITUD</h3>
      </div>
    </div>

    <div class="codigo-ref">
      <p><strong>C√≥digo del formulario:</strong> <%= data.codigoFormulario || '‚Äî' %></p>
      <p><strong>No. de Presentaci√≥n REF/LLE:</strong> <%= data.refLLE || '‚Äî' %></p>
    </div>

    <div class="bloque">
      <h3>Datos del solicitante</h3>
      <div class="grid-2">
        <p><strong>Nombre:</strong> <%= data.nombreSolicitante || '‚Äî' %></p>
        <p><strong>N√∫mero de documento:</strong>
          <% if (data.docTipo === 'DUI') { %>
            <%= data.dui || '‚Äî' %>
          <% } else if (data.docTipo === 'Pasaporte') { %>
            <%= data.pasaporte || '‚Äî' %>
          <% } else if (data.docTipo === 'Otro') { %>
            <%= data.otroDoc || '‚Äî' %>
          <% } else { %>‚Äî<% } %>
        </p>
        <p><strong>Tel√©fono:</strong> <%= data.telefono || '‚Äî' %></p>
        <p><strong>Correo electr√≥nico:</strong> <%= data.correo || '‚Äî' %></p>
        <p><strong>Municipio:</strong> <%= data.municipio || '‚Äî' %></p>
        <p><strong>Distrito:</strong> <%= data.distrito || '‚Äî' %></p>
        <p class="full"><strong>Domicilio:</strong> <%= data.domicilio || '‚Äî' %></p>
        <p><strong>Lugar de presentaci√≥n:</strong> <%= data.lugarPresentacion || '‚Äî' %></p>
        <p><strong>Fecha de presentaci√≥n:</strong> <%= data.fechaPresentacion || '‚Äî' %></p>
        <p><strong>Hora:</strong> <%= data.horaPresentacion || '‚Äî' %></p>
        <p><strong>Contacto tr√°mite:</strong> <%= data.contacto || '‚Äî' %></p>
        <p><strong>Plazo de respuesta:</strong> <%= data.plazo || '‚Äî' %></p>
        <p><strong>Tipo de documento:</strong> <%= data.docTipo || '‚Äî' %></p>
        <p><strong>¬øTitular del asiento?:</strong> <%= data.titular || '‚Äî' %></p>
        <p><strong>Car√°cter en que comparece:</strong>
          <%= Array.isArray(data.caracter)
            ? [...new Set(data.caracter)].join(', ')
            : (typeof data.caracter === 'string'
              ? [...new Set(data.caracter.split(','))].join(', ')
              : '‚Äî') %>
        </p>
      </div>
    </div>

    <div class="bloque">
      <h3>Datos del titular del asiento</h3>
      <div class="grid-2">
        <p class="full"><strong>Nombre:</strong>
          <%= [
            data.primerNombreTitular,
            data.segundoNombreTitular,
            data.primerApellidoTitular,
            data.segundoApellidoTitular,
            data.tercerApellidoTitular
          ].filter(Boolean).join(" ") || '‚Äî' %>
        </p>
        <p><strong>Tipo de documento:</strong> <%= data.docTitular || '‚Äî' %></p>
        <p><strong>N√∫mero de documento:</strong>
          <%= data.duiTitular || data.nuiTitular || data.otroTitular || '‚Äî' %>
        </p>
        <p><strong>Fecha del hecho:</strong> <%= data.fechaHecho || '‚Äî' %></p>
        <p><strong>Lugar del hecho:</strong> <%= data.lugarHecho || '‚Äî' %></p>
        <p class="full"><strong>Nombre de la madre:</strong>
          <%= [
            data.primerNombreMadre,
            data.segundoNombreMadre,
            data.primerApellidoMadre,
            data.segundoApellidoMadre,
            data.tercerApellidoMadre
          ].filter(Boolean).join(" ") || '‚Äî' %>
        </p>
        <p class="full"><strong>Nombre del padre:</strong>
          <%= [
            data.primerNombrePadre,
            data.segundoNombrePadre,
            data.primerApellidoPadre,
            data.segundoApellidoPadre,
            data.tercerApellidoPadre
          ].filter(Boolean).join(" ") || '‚Äî' %>
        </p>
      </div>
    </div>

    <div class="bloque">
      <h3>Declaraci√≥n solicitada</h3>
      <p><%= data.declaracion || '‚Äî' %></p>
    </div>
    
    <div class="bloque">
      <h3>Documentaci√≥n presentada</h3>
      <%
        const documentos = Array.isArray(data.doc)
          ? data.doc
          : [...(data.doc || []), ...(data.doc2 || [])];
      %>
      <% if (documentos && documentos.length) { %>
        <ul>
          <% documentos.forEach(d => { %>
            <li><%= d %></li>
          <% }) %>
        </ul>
      <% } else { %>
        <p>‚Äî</p>
      <% } %>
    </div>

    <div class="botones">
      <button onclick="window.print()">üñ®Ô∏è Imprimir</button>
      <a href="/formulario" class="btn">Nuevo formulario</a>
      <a href="/editar-formulario?codigo=<%= data.codigoFormulario %>" class="btn" style="background-color:#2e7d32; color:white; padding:0.5em 1.2em; border-radius:6px;">Editar</a>
    </div>
    <div class="pie-firma">
  <div class="firmas">
    <div class="firma-bloque firma-contenedor">
      <% if (firmaSolicitante) { %>
        <img src="<%= firmaSolicitante %>" alt="Firma solicitante" class="firma-img-ref firma-sobre-linea">
      <% } else { %>
        <div class="firma-espacio"></div>
      <% } %>
      <div class="linea-firma"></div>
      <p class="firma-texto"><strong>Usuario solicitante</strong><br>(Firma o huella)</p>
    </div>
    <div class="firma-bloque firma-contenedor">
      <% if (firmaUsuario) { %>
        <img src="<%= firmaUsuario %>" alt="Firma REF" class="firma-img-ref firma-sobre-linea">
      <% } else { %>
        <div class="firma-espacio"></div>
      <% } %>
      <div class="linea-firma"></div>
      <p class="firma-texto"><strong>REF</strong><br>(Nombre y firma)</p>
    </div>
  </div>
  <div class="separador-legal"></div>
  <p class="texto-legal">La informaci√≥n contenida en esta solicitud es de exclusiva responsabilidad de quien la complete...</p>
</div>

  </div>
</body>
</html>
